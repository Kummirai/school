<!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts - Inter -->
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>
<style>
  .container {
    max-width: 900px;
    background-color: #ffffff;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 30px;
  }
  h1,
  h2 {
    color: #343a40;
    margin-bottom: 25px;
    font-weight: 600;
  }
  .exercise-section {
    margin-bottom: 40px;
    padding: 25px;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    background-color: #fefefe;
  }
  .question-group {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    background-color: #ffffff;
  }
  .question-group label {
    font-weight: 500;
    margin-bottom: 8px;
    color: #495057;
  }
  .form-control {
    border-radius: 8px;
    padding: 10px 15px;
    border-color: #ced4da;
  }
  .form-control:focus {
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
    border-color: #86b7fe;
  }
  .btn-primary {
    background-color: #0d6efd;
    border-color: #0d6efd;
    border-radius: 10px;
    padding: 10px 25px;
    font-weight: 600;
    transition: background-color 0.3s ease, border-color 0.3s ease,
      transform 0.2s ease;
  }
  .btn-primary:hover {
    background-color: #0b5ed7;
    border-color: #0a58ca;
    transform: translateY(-2px);
  }
  .feedback-message {
    margin-top: 15px;
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: 500;
  }
  .feedback-correct {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }
  .feedback-incorrect {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
  .feedback-partial {
    background-color: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
  }
  .correct-answer {
    color: green;
    font-weight: bold;
  }
  .incorrect-answer {
    color: red;
    font-weight: bold;
  }
  .table th,
  .table td {
    vertical-align: middle;
  }
</style>

<div class="container">
  <h1 class="text-center mb-5">Algebra Practice Exercises</h1>

  <!-- Exercise 2 -->
  <div id="exercise2" class="exercise-section">
    <h2>Exercise 2: Creating Algebraic Expressions</h2>
    <p>
      Express each computational instruction as an algebraic expression. Use
      <code>x</code> as your input number (the variable). Remember to consider
      the order of operations (BODMAS) and use brackets where necessary to
      ensure the operations are performed in the intended order.
    </p>
    <div class="row">
      <!-- Question 1 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q1">1. Multiply by 4, then subtract 8.</label>
          <input
            type="text"
            class="form-control"
            id="e2q1"
            placeholder="e.g., 4x - 8"
          />
        </div>
      </div>
      <!-- Question 2 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q2">2. Subtract 8, then multiply by 4.</label>
          <input
            type="text"
            class="form-control"
            id="e2q2"
            placeholder="e.g., 4(x - 8)"
          />
        </div>
      </div>
      <!-- Question 3 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q3">3. Add 15, then divide by 5.</label>
          <input
            type="text"
            class="form-control"
            id="e2q3"
            placeholder="e.g., (x + 15) / 5"
          />
        </div>
      </div>
      <!-- Question 4 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q4">4. Divide by 5, then add 15.</label>
          <input
            type="text"
            class="form-control"
            id="e2q4"
            placeholder="e.g., x / 5 + 15"
          />
        </div>
      </div>
      <!-- Question 5 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q5">5. Multiply by 7, then add 2.</label>
          <input
            type="text"
            class="form-control"
            id="e2q5"
            placeholder="e.g., 7x + 2"
          />
        </div>
      </div>
      <!-- Question 6 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q6">6. Add 2, then multiply by 7.</label>
          <input
            type="text"
            class="form-control"
            id="e2q6"
            placeholder="e.g., 7(x + 2)"
          />
        </div>
      </div>
      <!-- Question 7 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q7">7. Subtract 10, then divide by 2.</label>
          <input
            type="text"
            class="form-control"
            id="e2q7"
            placeholder="e.g., (x - 10) / 2"
          />
        </div>
      </div>
      <!-- Question 8 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q8">8. Divide by 2, then subtract 10.</label>
          <input
            type="text"
            class="form-control"
            id="e2q8"
            placeholder="e.g., x / 2 - 10"
          />
        </div>
      </div>
      <!-- Question 9 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q9">9. Multiply by -3, then add 5.</label>
          <input
            type="text"
            class="form-control"
            id="e2q9"
            placeholder="e.g., -3x + 5"
          />
        </div>
      </div>
      <!-- Question 10 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="e2q10">10. Add 5, then multiply by -3.</label>
          <input
            type="text"
            class="form-control"
            id="e2q10"
            placeholder="e.g., -3(x + 5)"
          />
        </div>
      </div>
    </div>
    <button
      type="button"
      class="btn btn-primary mt-3"
      onclick="checkExercise2()"
    >
      Check Answers
    </button>
    <div id="feedback2" class="feedback-message mt-3 d-none"></div>
  </div>
</div>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Helper function to normalize string input for comparison
  function normalizeString(str) {
    if (typeof str !== "string") return "";
    return str.toLowerCase().replace(/\s/g, "").replace(/\*\*/g, "^"); // Normalize spaces and ** to ^ for exponents
  }

  // Helper function to compare numerical values, handling fractions
  function compareNumbers(input, correct) {
    input = String(input).trim();
    correct = String(correct).trim();

    // Handle fractions (e.g., "1/2", "3/4")
    const parseFraction = (s) => {
      const parts = s.split("/");
      if (parts.length === 2) {
        const num = parseFloat(parts[0]);
        const den = parseFloat(parts[1]);
        return den !== 0 ? num / den : NaN;
      }
      return parseFloat(s);
    };

    const parsedInput = parseFraction(input);
    const parsedCorrect = parseFraction(correct);

    // Use a small epsilon for floating point comparisons
    return Math.abs(parsedInput - parsedCorrect) < 1e-9;
  }

  // Function to display feedback
  function displayFeedback(feedbackId, message, type) {
    const feedbackDiv = document.getElementById(feedbackId);
    feedbackDiv.innerHTML = message;
    feedbackDiv.classList.remove(
      "d-none",
      "feedback-correct",
      "feedback-incorrect",
      "feedback-partial"
    );
    feedbackDiv.classList.add(`feedback-${type}`);
  }

  // Exercise 2: Creating Algebraic Expressions
  const correctAnswersE2 = {
    q1: ["4x-8", "4*x-8"],
    q2: ["4(x-8)", "(x-8)*4"],
    q3: ["(x+15)/5", "(x+15)/5", "x/5+3", "1/5(x+15)"], // (x+15)/5 = x/5 + 3
    q4: ["x/5+15", "x/5+15"],
    q5: ["7x+2", "7*x+2"],
    q6: ["7(x+2)", "(x+2)*7"],
    q7: ["(x-10)/2", "(x-10)/2", "x/2-5", "1/2(x-10)"], // (x-10)/2 = x/2 - 5
    q8: ["x/2-10", "x/2-10"],
    q9: ["-3x+5", "-3*x+5"],
    q10: ["-3(x+5)", "(x+5)*-3"],
  };

  function checkExercise2() {
    let score = 0;
    const totalQuestions = Object.keys(correctAnswersE2).length;
    let feedbackHtml = "";

    for (let i = 1; i <= totalQuestions; i++) {
      const qId = `q${i}`;
      const inputElement = document.getElementById(`e2${qId}`);
      const userAnswer = normalizeString(inputElement.value);
      const correctOptions = correctAnswersE2[qId].map(normalizeString);

      let isCorrect = correctOptions.includes(userAnswer);

      feedbackHtml += `<strong>Question ${i}:</strong> `;
      if (isCorrect) {
        score++;
        feedbackHtml += `<span class="correct-answer">${inputElement.value} (Correct)</span><br>`;
        inputElement.classList.remove("is-invalid");
        inputElement.classList.add("is-valid");
      } else {
        feedbackHtml += `<span class="incorrect-answer">${
          inputElement.value
        } (Incorrect, Correct options: ${correctAnswersE2[qId].join(
          " or "
        )})</span><br>`;
        inputElement.classList.remove("is-valid");
        inputElement.classList.add("is-invalid");
      }
    }

    const percentage = (score / totalQuestions) * 100;
    let feedbackType = "incorrect";
    if (score === totalQuestions) {
      feedbackType = "correct";
    } else if (score > 0) {
      feedbackType = "partial";
    }

    const finalMessage = `You scored ${score} out of ${totalQuestions} (${percentage.toFixed(
      2
    )}%).<br><br>${feedbackHtml}`;
    displayFeedback("feedback2", finalMessage, feedbackType);
  }
</script>
