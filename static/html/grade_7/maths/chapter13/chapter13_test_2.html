<!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts - Inter -->
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>
<style>
  .container {
    max-width: 900px;
    background-color: #ffffff;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 30px;
  }
  h1,
  h2 {
    color: #343a40;
    margin-bottom: 25px;
    font-weight: 600;
  }
  .test-section {
    margin-bottom: 40px;
    padding: 25px;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    background-color: #fefefe;
  }
  .question-group {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    background-color: #ffffff;
  }
  .question-group label {
    font-weight: 500;
    margin-bottom: 8px;
    color: #495057;
  }
  .form-control {
    border-radius: 8px;
    padding: 10px 15px;
    border-color: #ced4da;
  }
  .form-control:focus {
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
    border-color: #86b7fe;
  }
  .btn-primary {
    background-color: #0d6efd;
    border-color: #0d6efd;
    border-radius: 10px;
    padding: 10px 25px;
    font-weight: 600;
    transition: background-color 0.3s ease, border-color 0.3s ease,
      transform 0.2s ease;
  }
  .btn-primary:hover {
    background-color: #0b5ed7;
    border-color: #0a58ca;
    transform: translateY(-2px);
  }
  .feedback-message {
    margin-top: 15px;
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: 500;
  }
  .feedback-correct {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }
  .feedback-incorrect {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
  .feedback-partial {
    background-color: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
  }
  .correct-answer {
    color: green;
    font-weight: bold;
  }
  .incorrect-answer {
    color: red;
    font-weight: bold;
  }
  .table th,
  .table td {
    vertical-align: middle;
  }
</style>

<div class="container">
  <h1 class="text-center mb-5">Algebra Test 2</h1>
  <p class="text-center lead">
    This test contains 25 questions covering identifying components of algebraic
    expressions, creating algebraic expressions, and solving equations.
  </p>

  <!-- Part A: Identifying Components (9 questions) -->
  <div class="test-section">
    <h2>Part A: Identifying Components of Algebraic Expressions</h2>
    <p>
      For each expression, identify the variable, coefficient, exponent, and
      constant. Remember that some components might be "invisible" (e.g., a
      coefficient of 1, an exponent of 1, or a constant of 0).
    </p>
    <div class="table-responsive">
      <table class="table table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>Expression</th>
            <th>Variable</th>
            <th>Coefficient</th>
            <th>Exponent</th>
            <th>Constant</th>
          </tr>
        </thead>
        <tbody>
          <!-- Question A1 -->
          <tr>
            <td><code>7p + 1</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q1_var"
                placeholder="p"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q1_coeff"
                placeholder="7"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q1_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q1_const"
                placeholder="1"
              />
            </td>
          </tr>
          <!-- Question A2 -->
          <tr>
            <td><code>-x² - 5</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q2_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q2_coeff"
                placeholder="-1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q2_exp"
                placeholder="2"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q2_const"
                placeholder="-5"
              />
            </td>
          </tr>
          <!-- Question A3 -->
          <tr>
            <td><code>3c - 8</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q3_var"
                placeholder="c"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q3_coeff"
                placeholder="3"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q3_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q3_const"
                placeholder="-8"
              />
            </td>
          </tr>
          <!-- Question A4 -->
          <tr>
            <td><code>9y⁻² + 2</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q4_var"
                placeholder="y"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q4_coeff"
                placeholder="9"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q4_exp"
                placeholder="-2"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q4_const"
                placeholder="2"
              />
            </td>
          </tr>
          <!-- Question A5 -->
          <tr>
            <td><code>a</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q5_var"
                placeholder="a"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q5_coeff"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q5_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q5_const"
                placeholder="0"
              />
            </td>
          </tr>
          <!-- Question A6 -->
          <tr>
            <td><code>-b</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q6_var"
                placeholder="b"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q6_coeff"
                placeholder="-1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q6_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q6_const"
                placeholder="0"
              />
            </td>
          </tr>
          <!-- Question A7 -->
          <tr>
            <td><code>z³/4 - 3</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q7_var"
                placeholder="z"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q7_coeff"
                placeholder="1/4"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q7_exp"
                placeholder="3"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q7_const"
                placeholder="-3"
              />
            </td>
          </tr>
          <!-- Question A8 -->
          <tr>
            <td><code>k⁵/2 + 4</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q8_var"
                placeholder="k"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q8_coeff"
                placeholder="1/2"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q8_exp"
                placeholder="5"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q8_const"
                placeholder="4"
              />
            </td>
          </tr>
          <!-- Question A9 -->
          <tr>
            <td><code>(2/5)q + 1.5</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q9_var"
                placeholder="q"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q9_coeff"
                placeholder="2/5"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q9_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="t2q9_const"
                placeholder="1.5"
              />
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Part B: Creating Algebraic Expressions (8 questions) -->
  <div class="test-section">
    <h2>Part B: Creating Algebraic Expressions</h2>
    <p>
      Express each computational instruction as an algebraic expression. Use
      <code>x</code> as your input number (the variable). Remember to consider
      the order of operations (BODMAS) and use brackets where necessary to
      ensure the operations are performed in the intended order.
    </p>
    <div class="row">
      <!-- Question B10 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q10">10. Subtract 5, then multiply by 2.</label>
          <input
            type="text"
            class="form-control"
            id="t2q10"
            placeholder="e.g., 2(x - 5)"
          />
        </div>
      </div>
      <!-- Question B11 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q11">11. Multiply by 6, then subtract 1.</label>
          <input
            type="text"
            class="form-control"
            id="t2q11"
            placeholder="e.g., 6x - 1"
          />
        </div>
      </div>
      <!-- Question B12 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q12">12. Divide by 3, then add 10.</label>
          <input
            type="text"
            class="form-control"
            id="t2q12"
            placeholder="e.g., x / 3 + 10"
          />
        </div>
      </div>
      <!-- Question B13 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q13">13. Add 4, then divide by 9.</label>
          <input
            type="text"
            class="form-control"
            id="t2q13"
            placeholder="e.g., (x + 4) / 9"
          />
        </div>
      </div>
      <!-- Question B14 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q14">14. Quadruple a number, then add 5.</label>
          <input
            type="text"
            class="form-control"
            id="t2q14"
            placeholder="e.g., 4x + 5"
          />
        </div>
      </div>
      <!-- Question B15 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q15">15. Divide a number by 10, then add 1.</label>
          <input
            type="text"
            class="form-control"
            id="t2q15"
            placeholder="e.g., x / 10 + 1"
          />
        </div>
      </div>
      <!-- Question B16 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q16">16. Multiply by -5, then add 12.</label>
          <input
            type="text"
            class="form-control"
            id="t2q16"
            placeholder="e.g., -5x + 12"
          />
        </div>
      </div>
      <!-- Question B17 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q17">17. Add 8, then multiply by -1.</label>
          <input
            type="text"
            class="form-control"
            id="t2q17"
            placeholder="e.g., -(x + 8)"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- Part C: Solving Equations (8 questions) -->
  <div class="test-section">
    <h2>Part C: Solving Equations</h2>
    <p>
      Solve each equation for the unknown variable. Always state your final
      answer with the "therefore" symbol (∴).
    </p>
    <div class="row">
      <!-- Question C18 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q18">18. <code>x + 9 = 21</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q18"
            placeholder="e.g., x = 12"
          />
        </div>
      </div>
      <!-- Question C19 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q19">19. <code>y - 7 = 11</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q19"
            placeholder="e.g., y = 18"
          />
        </div>
      </div>
      <!-- Question C20 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q20">20. <code>24 / a = 6</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q20"
            placeholder="e.g., a = 4"
          />
        </div>
      </div>
      <!-- Question C21 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q21">21. <code>b / 7 = 3</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q21"
            placeholder="e.g., b = 21"
          />
        </div>
      </div>
      <!-- Question C22 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q22">22. <code>4c = 36</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q22"
            placeholder="e.g., c = 9"
          />
        </div>
      </div>
      <!-- Question C23 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q23">23. <code>m + 12 = 20</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q23"
            placeholder="e.g., m = 8"
          />
        </div>
      </div>
      <!-- Question C24 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q24">24. <code>2k + 5 = 19</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q24"
            placeholder="e.g., k = 7"
          />
        </div>
      </div>
      <!-- Question C25 -->
      <div class="col-md-6 mb-3">
        <div class="question-group">
          <label for="t2q25">25. <code>7d - 3 = 11</code></label>
          <input
            type="text"
            class="form-control"
            id="t2q25"
            placeholder="e.g., d = 2"
          />
        </div>
      </div>
    </div>
  </div>

  <div class="text-center">
    <button type="button" class="btn btn-primary mt-3" onclick="checkTest2()">
      Submit Test 2
    </button>
    <div id="feedback-test2" class="feedback-message mt-3 d-none"></div>
  </div>
</div>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Helper function to normalize string input for comparison
  function normalizeString(str) {
    if (typeof str !== "string") return "";
    return str.toLowerCase().replace(/\s/g, "").replace(/\*\*/g, "^"); // Normalize spaces and ** to ^ for exponents
  }

  // Helper function to compare numerical values, handling fractions
  function compareNumbers(input, correct) {
    input = String(input).trim();
    correct = String(correct).trim();

    // Handle fractions (e.g., "1/2", "3/4")
    const parseFraction = (s) => {
      const parts = s.split("/");
      if (parts.length === 2) {
        const num = parseFloat(parts[0]);
        const den = parseFloat(parts[1]);
        return den !== 0 ? num / den : NaN;
      }
      return parseFloat(s);
    };

    const parsedInput = parseFraction(input);
    const parsedCorrect = parseFraction(correct);

    // Use a small epsilon for floating point comparisons
    return Math.abs(parsedInput - parsedCorrect) < 1e-9;
  }

  // Function to display feedback
  function displayFeedback(feedbackId, message, type) {
    const feedbackDiv = document.getElementById(feedbackId);
    feedbackDiv.innerHTML = message;
    feedbackDiv.classList.remove(
      "d-none",
      "feedback-correct",
      "feedback-incorrect",
      "feedback-partial"
    );
    feedbackDiv.classList.add(`feedback-${type}`);
  }

  // Correct Answers for Test 2
  const correctAnswersTest2 = {
    // Part A: Identifying Components (9 questions)
    t2q1: { var: "p", coeff: "7", exp: "1", const: "1" },
    t2q2: { var: "x", coeff: "-1", exp: "2", const: "-5" },
    t2q3: { var: "c", coeff: "3", exp: "1", const: "-8" },
    t2q4: { var: "y", coeff: "9", exp: "-2", const: "2" },
    t2q5: { var: "a", coeff: "1", exp: "1", const: "0" },
    t2q6: { var: "b", coeff: "-1", exp: "1", const: "0" },
    t2q7: { var: "z", coeff: "1/4", exp: "3", const: "-3" },
    t2q8: { var: "k", coeff: "1/2", exp: "5", const: "4" },
    t2q9: { var: "q", coeff: "2/5", exp: "1", const: "1.5" },

    // Part B: Creating Algebraic Expressions (8 questions, from 10 to 17)
    t2q10: ["2(x-5)", "(x-5)*2"],
    t2q11: ["6x-1", "6*x-1"],
    t2q12: ["x/3+10"],
    t2q13: ["(x+4)/9"],
    t2q14: ["4x+5", "4*x+5"],
    t2q15: ["x/10+1"],
    t2q16: ["-5x+12", "-5*x+12"],
    t2q17: ["-(x+8)", "-1*(x+8)"],

    // Part C: Solving Equations (8 questions, from 18 to 25)
    t2q18: ["x=12", "12"],
    t2q19: ["y=18", "18"],
    t2q20: ["a=4", "4"],
    t2q21: ["b=21", "21"],
    t2q22: ["c=9", "9"],
    t2q23: ["m=8", "8"],
    t2q24: ["k=7", "7"],
    t2q25: ["d=2", "2"],
  };

  function checkTest2() {
    let score = 0;
    let feedbackHtml = "";
    const totalQuestions = 25; // Fixed total questions for the test

    // Part A: Identifying Components (9 questions)
    for (let i = 1; i <= 9; i++) {
      const qId = `t2q${i}`;
      const correct = correctAnswersTest2[qId];
      let allCorrectForQ = true;

      feedbackHtml += `<strong>Question ${i} (Part A):</strong><br>`;

      const fields = ["var", "coeff", "exp", "const"];
      fields.forEach((field) => {
        const inputElement = document.getElementById(`${qId}_${field}`);
        const userAnswer = normalizeString(inputElement.value);
        const correctAnswer = normalizeString(correct[field]);

        let isCorrect = false;
        if (field === "var") {
          isCorrect = userAnswer === correctAnswer;
        } else {
          isCorrect = compareNumbers(userAnswer, correctAnswer);
        }

        if (isCorrect) {
          feedbackHtml += `<span class="correct-answer">${field}: ${inputElement.value} (Correct)</span><br>`;
          inputElement.classList.remove("is-invalid");
          inputElement.classList.add("is-valid");
        } else {
          feedbackHtml += `<span class="incorrect-answer">${field}: ${inputElement.value} (Incorrect, Correct: ${correct[field]})</span><br>`;
          inputElement.classList.remove("is-valid");
          inputElement.classList.add("is-invalid");
          allCorrectForQ = false;
        }
      });
      if (allCorrectForQ) {
        score++;
      }
      feedbackHtml += "<br>";
    }

    // Part B: Creating Algebraic Expressions (8 questions, from 10 to 17)
    for (let i = 10; i <= 17; i++) {
      const qId = `t2q${i}`;
      const inputElement = document.getElementById(qId);
      const userAnswer = normalizeString(inputElement.value);
      const correctOptions = correctAnswersTest2[qId].map(normalizeString);

      let isCorrect = correctOptions.includes(userAnswer);

      feedbackHtml += `<strong>Question ${i} (Part B):</strong> `;
      if (isCorrect) {
        score++;
        feedbackHtml += `<span class="correct-answer">${inputElement.value} (Correct)</span><br>`;
        inputElement.classList.remove("is-invalid");
        inputElement.classList.add("is-valid");
      } else {
        feedbackHtml += `<span class="incorrect-answer">${
          inputElement.value
        } (Incorrect, Correct options: ${correctAnswersTest2[qId].join(
          " or "
        )})</span><br>`;
        inputElement.classList.remove("is-valid");
        inputElement.classList.add("is-invalid");
      }
    }
    feedbackHtml += "<br>";

    // Part C: Solving Equations (8 questions, from 18 to 25)
    for (let i = 18; i <= 25; i++) {
      const qId = `t2q${i}`;
      const inputElement = document.getElementById(qId);
      const userAnswer = normalizeString(inputElement.value);
      const correctOptions = correctAnswersTest2[qId].map(normalizeString);

      let isCorrect = correctOptions.includes(userAnswer);

      feedbackHtml += `<strong>Question ${i} (Part C):</strong> `;
      if (isCorrect) {
        score++;
        feedbackHtml += `<span class="correct-answer">${inputElement.value} (Correct)</span><br>`;
        inputElement.classList.remove("is-invalid");
        inputElement.classList.add("is-valid");
      } else {
        feedbackHtml += `<span class="incorrect-answer">${
          inputElement.value
        } (Incorrect, Correct options: ${correctAnswersTest2[qId].join(
          " or "
        )})</span><br>`;
        inputElement.classList.remove("is-valid");
        inputElement.classList.add("is-invalid");
      }
    }
    feedbackHtml += "<br>";

    const percentage = (score / totalQuestions) * 100;
    let feedbackType = "incorrect";
    if (score === totalQuestions) {
      feedbackType = "correct";
    } else if (score > 0) {
      feedbackType = "partial";
    }

    const finalMessage = `You scored ${score} out of ${totalQuestions} (${percentage.toFixed(
      2
    )}%).<br><br>${feedbackHtml}`;
    displayFeedback("feedback-test2", finalMessage, feedbackType);
  }
</script>
