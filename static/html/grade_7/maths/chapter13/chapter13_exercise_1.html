<!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts - Inter -->
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>
<style>
  .container {
    max-width: 900px;
    background-color: #ffffff;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 30px;
  }
  h1,
  h2 {
    color: #343a40;
    margin-bottom: 25px;
    font-weight: 600;
  }
  .exercise-section {
    margin-bottom: 40px;
    padding: 25px;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    background-color: #fefefe;
  }
  .question-group {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    background-color: #ffffff;
  }
  .question-group label {
    font-weight: 500;
    margin-bottom: 8px;
    color: #495057;
  }
  .form-control {
    border-radius: 8px;
    padding: 10px 15px;
    border-color: #ced4da;
  }
  .form-control:focus {
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
    border-color: #86b7fe;
  }
  .btn-primary {
    background-color: #0d6efd;
    border-color: #0d6efd;
    border-radius: 10px;
    padding: 10px 25px;
    font-weight: 600;
    transition: background-color 0.3s ease, border-color 0.3s ease,
      transform 0.2s ease;
  }
  .btn-primary:hover {
    background-color: #0b5ed7;
    border-color: #0a58ca;
    transform: translateY(-2px);
  }
  .feedback-message {
    margin-top: 15px;
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: 500;
  }
  .feedback-correct {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }
  .feedback-incorrect {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
  .feedback-partial {
    background-color: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
  }
  .correct-answer {
    color: green;
    font-weight: bold;
  }
  .incorrect-answer {
    color: red;
    font-weight: bold;
  }
  .table th,
  .table td {
    vertical-align: middle;
  }
</style>

<div class="container">
  <h1 class="text-center mb-5">Algebra Practice Exercises</h1>

  <!-- Exercise 1 -->
  <div id="exercise1" class="exercise-section">
    <h2>Exercise 1: Identifying Components of Algebraic Expressions</h2>
    <p>
      For each expression, identify the variable, coefficient, exponent, and
      constant. Remember that some components might be "invisible" (e.g., a
      coefficient of 1, an exponent of 1, or a constant of 0).
    </p>
    <div class="table-responsive">
      <table class="table table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>Expression</th>
            <th>Variable</th>
            <th>Coefficient</th>
            <th>Exponent</th>
            <th>Constant</th>
          </tr>
        </thead>
        <tbody>
          <!-- Question 1 -->
          <tr>
            <td><code>4x + 3</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q1_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q1_coeff"
                placeholder="4"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q1_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q1_const"
                placeholder="3"
              />
            </td>
          </tr>
          <!-- Question 2 -->
          <tr>
            <td><code>-3x³ - 6</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q2_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q2_coeff"
                placeholder="-3"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q2_exp"
                placeholder="3"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q2_const"
                placeholder="-6"
              />
            </td>
          </tr>
          <!-- Question 3 -->
          <tr>
            <td><code>2d + 5</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q3_var"
                placeholder="d"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q3_coeff"
                placeholder="2"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q3_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q3_const"
                placeholder="5"
              />
            </td>
          </tr>
          <!-- Question 4 -->
          <tr>
            <td><code>6x⁻³ + 7</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q4_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q4_coeff"
                placeholder="6"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q4_exp"
                placeholder="-3"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q4_const"
                placeholder="7"
              />
            </td>
          </tr>
          <!-- Question 5 -->
          <tr>
            <td><code>x</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q5_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q5_coeff"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q5_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q5_const"
                placeholder="0"
              />
            </td>
          </tr>
          <!-- Question 6 -->
          <tr>
            <td><code>-x</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q6_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q6_coeff"
                placeholder="-1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q6_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q6_const"
                placeholder="0"
              />
            </td>
          </tr>
          <!-- Question 7 -->
          <tr>
            <td><code>x²/2 - 2</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q7_var"
                placeholder="x"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q7_coeff"
                placeholder="1/2"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q7_exp"
                placeholder="2"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q7_const"
                placeholder="-2"
              />
            </td>
          </tr>
          <!-- Question 8 -->
          <tr>
            <td><code>p⁶/3 + 1</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q8_var"
                placeholder="p"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q8_coeff"
                placeholder="1/3"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q8_exp"
                placeholder="6"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q8_const"
                placeholder="1"
              />
            </td>
          </tr>
          <!-- Question 9 -->
          <tr>
            <td><code>y - 5</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q9_var"
                placeholder="y"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q9_coeff"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q9_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q9_const"
                placeholder="-5"
              />
            </td>
          </tr>
          <!-- Question 10 -->
          <tr>
            <td><code>(3/4)p + 6.5</code></td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q10_var"
                placeholder="p"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q10_coeff"
                placeholder="3/4"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q10_exp"
                placeholder="1"
              />
            </td>
            <td>
              <input
                type="text"
                class="form-control"
                id="e1q10_const"
                placeholder="6.5"
              />
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <button
      type="button"
      class="btn btn-primary mt-3"
      onclick="checkExercise1()"
    >
      Check Answers
    </button>
    <div id="feedback1" class="feedback-message mt-3 d-none"></div>
  </div>
</div>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Helper function to normalize string input for comparison
  function normalizeString(str) {
    if (typeof str !== "string") return "";
    return str.toLowerCase().replace(/\s/g, "").replace(/\*\*/g, "^"); // Normalize spaces and ** to ^ for exponents
  }

  // Helper function to compare numerical values, handling fractions
  function compareNumbers(input, correct) {
    input = String(input).trim();
    correct = String(correct).trim();

    // Handle fractions (e.g., "1/2", "3/4")
    const parseFraction = (s) => {
      const parts = s.split("/");
      if (parts.length === 2) {
        const num = parseFloat(parts[0]);
        const den = parseFloat(parts[1]);
        return den !== 0 ? num / den : NaN;
      }
      return parseFloat(s);
    };

    const parsedInput = parseFraction(input);
    const parsedCorrect = parseFraction(correct);

    // Use a small epsilon for floating point comparisons
    return Math.abs(parsedInput - parsedCorrect) < 1e-9;
  }

  // Function to display feedback
  function displayFeedback(feedbackId, message, type) {
    const feedbackDiv = document.getElementById(feedbackId);
    feedbackDiv.innerHTML = message;
    feedbackDiv.classList.remove(
      "d-none",
      "feedback-correct",
      "feedback-incorrect",
      "feedback-partial"
    );
    feedbackDiv.classList.add(`feedback-${type}`);
  }

  // Exercise 1: Identifying Components of Algebraic Expressions
  const correctAnswersE1 = {
    q1: { var: "x", coeff: "4", exp: "1", const: "3" },
    q2: { var: "x", coeff: "-3", exp: "3", const: "-6" },
    q3: { var: "d", coeff: "2", exp: "1", const: "5" },
    q4: { var: "x", coeff: "6", exp: "-3", const: "7" },
    q5: { var: "x", coeff: "1", exp: "1", const: "0" },
    q6: { var: "x", coeff: "-1", exp: "1", const: "0" },
    q7: { var: "x", coeff: "1/2", exp: "2", const: "-2" },
    q8: { var: "p", coeff: "1/3", exp: "6", const: "1" },
    q9: { var: "y", coeff: "1", exp: "1", const: "-5" },
    q10: { var: "p", coeff: "3/4", exp: "1", const: "6.5" },
  };

  function checkExercise1() {
    let score = 0;
    const totalQuestions = Object.keys(correctAnswersE1).length;
    let feedbackHtml = "";

    for (let i = 1; i <= totalQuestions; i++) {
      const qId = `q${i}`;
      const correct = correctAnswersE1[qId];
      let allCorrectForQ = true;

      feedbackHtml += `<strong>Question ${i}:</strong><br>`;

      const fields = ["var", "coeff", "exp", "const"];
      fields.forEach((field) => {
        const inputElement = document.getElementById(`e1${qId}_${field}`);
        const userAnswer = normalizeString(inputElement.value);
        const correctAnswer = normalizeString(correct[field]);

        let isCorrect = false;
        if (field === "var") {
          isCorrect = userAnswer === correctAnswer;
        } else {
          isCorrect = compareNumbers(userAnswer, correctAnswer);
        }

        if (isCorrect) {
          feedbackHtml += `<span class="correct-answer">${field}: ${inputElement.value} (Correct)</span><br>`;
          inputElement.classList.remove("is-invalid");
          inputElement.classList.add("is-valid");
        } else {
          feedbackHtml += `<span class="incorrect-answer">${field}: ${inputElement.value} (Incorrect, Correct: ${correct[field]})</span><br>`;
          inputElement.classList.remove("is-valid");
          inputElement.classList.add("is-invalid");
          allCorrectForQ = false;
        }
      });
      if (allCorrectForQ) {
        score++;
      }
      feedbackHtml += "<br>";
    }

    const percentage = (score / totalQuestions) * 100;
    let feedbackType = "incorrect";
    if (score === totalQuestions) {
      feedbackType = "correct";
    } else if (score > 0) {
      feedbackType = "partial";
    }

    const finalMessage = `You scored ${score} out of ${totalQuestions} (${percentage.toFixed(
      2
    )}%).<br><br>${feedbackHtml}`;
    displayFeedback("feedback1", finalMessage, feedbackType);
  }
</script>
