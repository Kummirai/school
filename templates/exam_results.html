{% extends "base.html" %}
{% block title %}Exam Results{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>Results for {{ exam_details.title }}</h1>
    <p>Score: {{ "%.2f"|format(result.score) }}%</p>
    
    <div class="mt-4">
        <h2>Review Your Answers</h2>
        {% for question in questions_for_review %}
        <div class="card mb-3 {% if question.is_correct %}border-success{% else %}border-danger{% endif %}">
            <div class="card-header">
                Question {{ question.number }}
                {% if question.is_correct %}
                    <span class="badge bg-success">Correct</span>
                {% else %}
                    <span class="badge bg-danger">Incorrect</span>
                {% endif %}
            </div>
            <div class="card-body">
                <p class="card-text">{{ question.question_text | safe }}</p>
                
                {% if question.type == 'matching' %}
                    <strong>Your Answers:</strong>
                    <ul>
                    {% for stem, answer in question.user_answer.items() %}
                        <li>{{ stem }}: {{ answer }}</li>
                    {% endfor %}
                    </ul>
                    {% if not question.is_correct %}
                    <strong>Correct Answers:</strong>
                    <ul>
                    {% for stem, answer in question.correct_answer.items() %}
                        <li>{{ stem }}: {{ answer }}</li>
                    {% endfor %}
                    </ul>
                    {% endif %}
                {% else %}
                    <p>Your answer: {{ question.user_answer if question.user_answer else "No answer provided" }}</p>
                    {% if not question.is_correct %}
                    <p>Correct answer: {{ question.correct_answer }}</p>
                    {% endif %}
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    <a href="{{ url_for('exam.exam_practice') }}" class="btn btn-primary">Back to Exams</a>
</div>
{% endblock %}
