{% extends "base.html" %} {% block title %}{{ exam.title }}{% endblock %} {%
block content %}
<head>
  <meta
    name="exam-title"
    content="Grade 7 English Exam: Language and Comprehension"
  />
  <meta name="exam-grade" content="7" />
  <meta name="exam-subject" content="English" />
  <meta
    name="exam-description"
    content="Comprehensive exam on reading comprehension, grammar, and language usage for Grade 7 English."
  />
  <meta name="exam-duration" content="90" />
  <meta name="exam-difficulty" content="Medium" />
  <style>
    .correct .form-check-label {
      color: #198754; /* Bootstrap success green */
      font-weight: bold;
    }
    .incorrect .form-check-label {
      color: #dc3545; /* Bootstrap danger red */
      text-decoration: line-through;
    }
    .correct-answer .form-check-label {
      color: #198754;
      font-weight: bold;
    }
    .feedback {
      font-size: 0.9em;
      font-weight: bold;
    }
    .correct-feedback {
      color: #198754;
    }
    .incorrect-feedback {
      color: #dc3545;
    }
    .comprehension-passage {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
    }
  </style>
</head>
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">{{ exam.title }}</h1>
    <div id="timer" class="fw-bold fs-4 text-danger"></div>
  </div>
  <p>{{ exam.description }}</p>
  <form
    action="{{ url_for('exam.submit_exam', exam_id=exam.id) }}"
    method="post"
    id="exam-form"
  >
    <div id="questions-container">
      <!-- Section 1: Reading Comprehension -->
      <div class="comprehension-passage">
        <h4>Reading Passage:</h4>
        <p>
          The Great Migration was a remarkable event in nature. Every year,
          millions of wildebeests, zebras, and gazelles travel across the
          Serengeti in search of fresh grass and water. This journey covers
          about 1,800 miles and is fraught with danger. Predators like lions and
          crocodiles wait for the weak or young animals that can't keep up with
          the herd. The migration follows the rains, as the animals move to
          areas where rain has recently fallen, creating new growth. This
          ancient pattern has continued for thousands of years, demonstrating
          nature's incredible balance.
        </p>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            1. What is the main purpose of the Great Migration?
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_1"
              id="q1_option1"
              value="To escape from predators"
            />
            <label class="form-check-label" for="q1_option1"
              >To escape from predators</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_1"
              id="q1_option2"
              value="To find fresh grass and water"
              correct="true"
            />
            <label class="form-check-label" for="q1_option2"
              >To find fresh grass and water</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_1"
              id="q1_option3"
              value="To explore new territories"
            />
            <label class="form-check-label" for="q1_option3"
              >To explore new territories</label
            >
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            2. Which word in the passage means "full of danger"?
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_2"
              id="q2_option1"
              value="remarkable"
            />
            <label class="form-check-label" for="q2_option1">remarkable</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_2"
              id="q2_option2"
              value="fraught"
              correct="true"
            />
            <label class="form-check-label" for="q2_option2">fraught</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_2"
              id="q2_option3"
              value="ancient"
            />
            <label class="form-check-label" for="q2_option3">ancient</label>
          </div>
        </div>
      </div>

      <!-- Section 2: Nouns and Pronouns -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">3. Which of the following is a proper noun?</p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_3"
              id="q3_option1"
              value="animal"
            />
            <label class="form-check-label" for="q3_option1">animal</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_3"
              id="q3_option2"
              value="Serengeti"
              correct="true"
            />
            <label class="form-check-label" for="q3_option2">Serengeti</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_3"
              id="q3_option3"
              value="grass"
            />
            <label class="form-check-label" for="q3_option3">grass</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            4. Choose the correct pronoun to complete the sentence: "The
            wildebeests travel far, and ______ face many dangers."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_4"
              id="q4_option1"
              value="it"
            />
            <label class="form-check-label" for="q4_option1">it</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_4"
              id="q4_option2"
              value="they"
              correct="true"
            />
            <label class="form-check-label" for="q4_option2">they</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_4"
              id="q4_option3"
              value="them"
            />
            <label class="form-check-label" for="q4_option3">them</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            5. Identify the collective noun in this sentence: "A herd of
            wildebeests crossed the river."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_5"
              id="q5_option1"
              value="wildebeests"
            />
            <label class="form-check-label" for="q5_option1">wildebeests</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_5"
              id="q5_option2"
              value="herd"
              correct="true"
            />
            <label class="form-check-label" for="q5_option2">herd</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_5"
              id="q5_option3"
              value="river"
            />
            <label class="form-check-label" for="q5_option3">river</label>
          </div>
        </div>
      </div>

      <!-- Section 3: Adjectives and Adverbs -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            6. Which word is an adjective in this sentence: "The young gazelle
            ran quickly from the hungry lion."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_6"
              id="q6_option1"
              value="quickly"
            />
            <label class="form-check-label" for="q6_option1">quickly</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_6"
              id="q6_option2"
              value="young"
              correct="true"
            />
            <label class="form-check-label" for="q6_option2">young</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_6"
              id="q6_option3"
              value="ran"
            />
            <label class="form-check-label" for="q6_option3">ran</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            7. Choose the correct adverb to complete this sentence: "The zebras
            moved _____ across the plain."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_7"
              id="q7_option1"
              value="graceful"
            />
            <label class="form-check-label" for="q7_option1">graceful</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_7"
              id="q7_option2"
              value="gracefully"
              correct="true"
            />
            <label class="form-check-label" for="q7_option2">gracefully</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_7"
              id="q7_option3"
              value="grace"
            />
            <label class="form-check-label" for="q7_option3">grace</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">8. Which of these is a comparative adjective?</p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_8"
              id="q8_option1"
              value="big"
            />
            <label class="form-check-label" for="q8_option1">big</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_8"
              id="q8_option2"
              value="bigger"
              correct="true"
            />
            <label class="form-check-label" for="q8_option2">bigger</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_8"
              id="q8_option3"
              value="biggest"
            />
            <label class="form-check-label" for="q8_option3">biggest</label>
          </div>
        </div>
      </div>

      <!-- Section 4: Verbs and Tenses -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            9. Identify the verb in this sentence: "The crocodile waits
            patiently in the water."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_9"
              id="q9_option1"
              value="crocodile"
            />
            <label class="form-check-label" for="q9_option1">crocodile</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_9"
              id="q9_option2"
              value="patiently"
            />
            <label class="form-check-label" for="q9_option2">patiently</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_9"
              id="q9_option3"
              value="waits"
              correct="true"
            />
            <label class="form-check-label" for="q9_option3">waits</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            10. Choose the correct past tense form: "Yesterday, the herd _____
            across the river."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_10"
              id="q10_option1"
              value="swim"
            />
            <label class="form-check-label" for="q10_option1">swim</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_10"
              id="q10_option2"
              value="swam"
              correct="true"
            />
            <label class="form-check-label" for="q10_option2">swam</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_10"
              id="q10_option3"
              value="swum"
            />
            <label class="form-check-label" for="q10_option3">swum</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            11. Which sentence uses the present continuous tense correctly?
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_11"
              id="q11_option1"
              value="The lions hunt at night."
            />
            <label class="form-check-label" for="q11_option1"
              >The lions hunt at night.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_11"
              id="q11_option2"
              value="The lions are hunting now."
              correct="true"
            />
            <label class="form-check-label" for="q11_option2"
              >The lions are hunting now.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_11"
              id="q11_option3"
              value="The lions hunted yesterday."
            />
            <label class="form-check-label" for="q11_option3"
              >The lions hunted yesterday.</label
            >
          </div>
        </div>
      </div>

      <!-- Section 5: Prepositions and Conjunctions -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            12. Choose the correct preposition: "The animals gather _____ the
            waterhole."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_12"
              id="q12_option1"
              value="at"
              correct="true"
            />
            <label class="form-check-label" for="q12_option1">at</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_12"
              id="q12_option2"
              value="in"
            />
            <label class="form-check-label" for="q12_option2">in</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_12"
              id="q12_option3"
              value="on"
            />
            <label class="form-check-label" for="q12_option3">on</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            13. Which conjunction best completes this sentence: "The migration
            is dangerous, _____ it's necessary for survival."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_13"
              id="q13_option1"
              value="or"
            />
            <label class="form-check-label" for="q13_option1">or</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_13"
              id="q13_option2"
              value="but"
              correct="true"
            />
            <label class="form-check-label" for="q13_option2">but</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_13"
              id="q13_option3"
              value="so"
            />
            <label class="form-check-label" for="q13_option3">so</label>
          </div>
        </div>
      </div>

      <!-- Section 6: Sentence Structure -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">14. Which of these is a complete sentence?</p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_14"
              id="q14_option1"
              value="Running across the plain."
            />
            <label class="form-check-label" for="q14_option1"
              >Running across the plain.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_14"
              id="q14_option2"
              value="The wildebeests migrate annually."
              correct="true"
            />
            <label class="form-check-label" for="q14_option2"
              >The wildebeests migrate annually.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_14"
              id="q14_option3"
              value="When the rains come."
            />
            <label class="form-check-label" for="q14_option3"
              >When the rains come.</label
            >
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            15. Identify the subject in this sentence: "Every year, thousands of
            animals cross the Mara River."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_15"
              id="q15_option1"
              value="Every year"
            />
            <label class="form-check-label" for="q15_option1">Every year</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_15"
              id="q15_option2"
              value="thousands of animals"
              correct="true"
            />
            <label class="form-check-label" for="q15_option2"
              >thousands of animals</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_15"
              id="q15_option3"
              value="the Mara River"
            />
            <label class="form-check-label" for="q15_option3"
              >the Mara River</label
            >
          </div>
        </div>
      </div>

      <!-- Section 7: Vocabulary -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            16. What is the best synonym for "remarkable" as used in the
            passage?
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_16"
              id="q16_option1"
              value="ordinary"
            />
            <label class="form-check-label" for="q16_option1">ordinary</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_16"
              id="q16_option2"
              value="extraordinary"
              correct="true"
            />
            <label class="form-check-label" for="q16_option2"
              >extraordinary</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_16"
              id="q16_option3"
              value="small"
            />
            <label class="form-check-label" for="q16_option3">small</label>
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            17. What does "ancient" mean in the context of the passage?
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_17"
              id="q17_option1"
              value="modern"
            />
            <label class="form-check-label" for="q17_option1">modern</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_17"
              id="q17_option2"
              value="very old"
              correct="true"
            />
            <label class="form-check-label" for="q17_option2">very old</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_17"
              id="q17_option3"
              value="temporary"
            />
            <label class="form-check-label" for="q17_option3">temporary</label>
          </div>
        </div>
      </div>

      <!-- Section 8: Writing and Composition -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">18. Which sentence is correctly punctuated?</p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_18"
              id="q18_option1"
              value="The animals travel far, they face many dangers."
            />
            <label class="form-check-label" for="q18_option1"
              >The animals travel far, they face many dangers.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_18"
              id="q18_option2"
              value="The animals travel far; they face many dangers."
              correct="true"
            />
            <label class="form-check-label" for="q18_option2"
              >The animals travel far; they face many dangers.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_18"
              id="q18_option3"
              value="The animals travel far they face many dangers."
            />
            <label class="form-check-label" for="q18_option3"
              >The animals travel far they face many dangers.</label
            >
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            19. Choose the best topic sentence for a paragraph about the
            migration:
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_19"
              id="q19_option1"
              value="Lions are dangerous predators."
            />
            <label class="form-check-label" for="q19_option1"
              >Lions are dangerous predators.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_19"
              id="q19_option2"
              value="The annual migration is one of nature's most spectacular events."
              correct="true"
            />
            <label class="form-check-label" for="q19_option2"
              >The annual migration is one of nature's most spectacular
              events.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_19"
              id="q19_option3"
              value="Africa has many different ecosystems."
            />
            <label class="form-check-label" for="q19_option3"
              >Africa has many different ecosystems.</label
            >
          </div>
        </div>
      </div>

      <!-- Section 9: Mixed Grammar -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            20. Identify the direct object in this sentence: "The cheetah chased
            the gazelle across the plain."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_20"
              id="q20_option1"
              value="cheetah"
            />
            <label class="form-check-label" for="q20_option1">cheetah</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_20"
              id="q20_option2"
              value="gazelle"
              correct="true"
            />
            <label class="form-check-label" for="q20_option2">gazelle</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_20"
              id="q20_option3"
              value="plain"
            />
            <label class="form-check-label" for="q20_option3">plain</label>
          </div>
        </div>
      </div>

      <!-- Section 10: Short Answer -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            21. Write a sentence using the word "migration" correctly:
            <textarea
              class="form-control"
              name="question_21"
              rows="2"
            ></textarea>
          </p>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            22. Combine these sentences into one: "The rains come. The grass
            grows. The animals follow."
            <textarea
              class="form-control"
              name="question_22"
              rows="2"
            ></textarea>
          </p>
        </div>
      </div>

      <!-- Section 11: Advanced Grammar -->
      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">23. Which sentence is in passive voice?</p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_23"
              id="q23_option1"
              value="The lion chased the zebra."
            />
            <label class="form-check-label" for="q23_option1"
              >The lion chased the zebra.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_23"
              id="q23_option2"
              value="The zebra was chased by the lion."
              correct="true"
            />
            <label class="form-check-label" for="q23_option2"
              >The zebra was chased by the lion.</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_23"
              id="q23_option3"
              value="Both the lion and zebra ran quickly."
            />
            <label class="form-check-label" for="q23_option3"
              >Both the lion and zebra ran quickly.</label
            >
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            24. Identify the prepositional phrase: "After the long journey, the
            animals rested near the water."
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_24"
              id="q24_option1"
              value="After the long journey"
            />
            <label class="form-check-label" for="q24_option1"
              >After the long journey</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_24"
              id="q24_option2"
              value="the animals rested"
            />
            <label class="form-check-label" for="q24_option2"
              >the animals rested</label
            >
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_24"
              id="q24_option3"
              value="near the water"
              correct="true"
            />
            <label class="form-check-label" for="q24_option3"
              >near the water</label
            >
          </div>
        </div>
      </div>

      <div class="card mb-3 question">
        <div class="card-body">
          <p class="card-text">
            25. Which word is an interjection in this sentence: "Wow! Look at
            that huge herd of wildebeests!"
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_25"
              id="q25_option1"
              value="Wow!"
              correct="true"
            />
            <label class="form-check-label" for="q25_option1">Wow!</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_25"
              id="q25_option2"
              value="Look"
            />
            <label class="form-check-label" for="q25_option2">Look</label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="question_25"
              id="q25_option3"
              value="huge"
            />
            <label class="form-check-label" for="q25_option3">huge</label>
          </div>
        </div>
      </div>
    </div>
    <div id="results" class="mt-4"></div>
    <button type="button" id="check-answers-btn" class="btn btn-primary">
      Check Answers
    </button>
    <button
      type="submit"
      id="submit-btn"
      class="btn btn-success"
      style="display: none"
    >
      Submit Exam
    </button>
  </form>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
      const form = document.getElementById('exam-form');
      const timerDisplay = document.getElementById('timer');
      const durationMinutes = {{ exam.duration_minutes }};
      let timeRemaining = durationMinutes * 60; // in seconds
      let timerInterval;

      function updateTimer() {
          const minutes = Math.floor(timeRemaining / 60);
          const seconds = timeRemaining % 60;
          timerDisplay.textContent = `Time Left: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

          if (timeRemaining <= 0) {
              clearInterval(timerInterval);
              alert('Time is up! Your exam will be submitted automatically.');
              submitExam();
          } else {
              timeRemaining--;
          }
      }

      function submitExam() {
          // Create a hidden input to indicate auto-submission
          const autoSubmitInput = document.createElement('input');
          autoSubmitInput.type = 'hidden';
          autoSubmitInput.name = 'auto_submit';
          autoSubmitInput.value = 'true';
          form.appendChild(autoSubmitInput);
          form.submit();
      }

      // Start the timer when the page loads
      timerInterval = setInterval(updateTimer, 1000);

      // Warn user before navigating away
      window.addEventListener('beforeunload', function (e) {
          // Only warn if the exam hasn't been submitted yet
          if (form.dataset.submitted !== 'true') {
              const confirmationMessage = 'Navigating away from this page will automatically submit and grade your exam. Are you sure you want to leave?';
              (e || window.event).returnValue = confirmationMessage; // Standard for most browsers
              return confirmationMessage; // For some older browsers
          }
      });

      // Auto-submit if user navigates away
      window.addEventListener('unload', function () {
          if (form.dataset.submitted !== 'true') {
              // This will only work if the browser allows synchronous XHR on unload,
              // which is generally deprecated. A better approach is to rely on
              // the server-side to handle incomplete exams or use Beacon API.
              // For this exercise, we'll assume a simple form submission is sufficient
              // if the user confirms leaving.
              // However, the primary mechanism for auto-submission will be the timer.
              // The beforeunload warning is the main deterrent for accidental navigation.
              // For actual submission on unload, a small fetch request might be more reliable
              // but is outside the scope of simple form submission.
              // For now, we'll just ensure the timer handles the auto-submit.
          }
      });

      // Mark form as submitted when the submit button is clicked
      form.addEventListener('submit', function() {
          form.dataset.submitted = 'true';
          clearInterval(timerInterval); // Stop the timer on manual submission
      });
  });
</script>
{% endblock %}
