{% extends "base.html" %} {% block content %}

<div class="container mt-4">
  <div class="row mb-3">
    <div class="col-md-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-md-3">
              <label for="subjectSelect" class="form-label"
                >Select Subject:</label
              >
              <select class="form-select" id="subjectSelect">
                <option value="Mathematics">Mathematics</option>
                <option value="Physical Sciences">Physical Sciences</option>
                <option value="Life Sciences">Life Sciences</option>
                <option value="English">English</option>
              </select>
            </div>
            <div class="col-md-9">
              <h3 id="currentSubjectDisplay" class="mt-4">
                <i class="bi bi-book me-2"></i>Mathematics
              </h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-3">
      <div class="accordion mb-4" id="gradesAccordion">
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button
              class="accordion-button bg-danger text-white"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapseGrades"
              aria-expanded="true"
              aria-controls="collapseGrades"
            >
              <i class="bi bi-mortarboard me-2"></i> Grades
            </button>
          </h2>
          <div
            id="collapseGrades"
            class="accordion-collapse collapse"
            data-bs-parent="#gradesAccordion"
          >
            <div class="accordion-body p-0">
              <div class="list-group list-group-flush" id="gradeList">
                <!-- Grades will be loaded here -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="accordion" id="topicsAccordion">
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button
              class="accordion-button bg-danger text-white"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapseTopics"
              aria-expanded="true"
              aria-controls="collapseTopics"
            >
              <i class="bi bi-journal-bookmark me-2"></i> Topics
            </button>
          </h2>
          <div
            id="collapseTopics"
            class="accordion-collapse collapse"
            data-bs-parent="#topicsAccordion"
          >
            <div class="accordion-body p-0">
              <div class="list-group list-group-flush" id="topicList">
                <!-- Topics will be loaded here -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-9">
      <div id="contentArea">
        <div class="text-center py-5">
          <i class="bi bi-book" style="font-size: 3rem; color: #dc3545"></i>
          <h2 class="mt-3">Welcome to Study Guides</h2>
          <p class="lead">
            Select a subject, grade, and topic to begin learning
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .quiz-option {
    padding: 10px;
    margin: 5px 0;
    border: 1px solid #ddd;
    border-radius: 5px;
    cursor: pointer;
  }

  .quiz-option:hover {
    background-color: #f8f9fa;
  }

  .correct {
    background-color: #d4edda;
    border-color: #c3e6cb;
  }

  .incorrect {
    background-color: #f8d7da;
    border-color: #f5c6cb;
  }

  .subject-card {
    transition: transform 0.2s;
  }

  .subject-card:hover {
    transform: translateY(-5px);
  }

  /* Custom accordion styling */
  .accordion-button:not(.collapsed) {
    color: white;
    background-color: #dc3545;
  }

  .accordion-button:focus {
    box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
  }

  .list-group-item {
    border-left: 0;
    border-right: 0;
  }

  .list-group-item:first-child {
    border-top: 0;
  }

  .list-group-item:last-child {
    border-bottom: 0;
  }
</style>
<script>
  // Enhanced QuizManager with unanswered question handling
  const QuizManager = {
    // Toggle question sets with animation
    toggleQuestions: function (setId) {
      const set = document.getElementById(setId);
      if (set) {
        set.style.transition = "all 0.3s ease";
        set.style.display = set.style.display === "none" ? "block" : "none";

        if (set.style.display === "block") {
          setTimeout(() => {
            set.scrollIntoView({ behavior: "smooth", block: "nearest" });
          }, 50);
        }
      }
    },

    // Handle answer selection with visual feedback
    selectAnswer: function (option, correctType) {
      if (!option || !correctType) return;

      const questionDiv = option.closest(".quiz-question");
      if (!questionDiv) return;

      const options = questionDiv.querySelectorAll(".quiz-option");
      const correctValue = correctType.toLowerCase();

      options.forEach((opt) => {
        opt.classList.remove("bg-success", "bg-danger");
        if (opt === option) {
          const isCorrect = opt.textContent
            .toLowerCase()
            .includes(correctValue);
          opt.classList.add(isCorrect ? "bg-success" : "bg-danger");
        }
      });
    },

    // Validate all questions in a set with unanswered handling
    validateSet: function (setId, correctAnswers) {
      const set = document.getElementById(setId);
      if (!set || !correctAnswers) return;

      let score = 0;
      const questions = set.querySelectorAll(".quiz-question");
      const results = {
        total: questions.length,
        correct: 0,
        incorrect: 0,
        unanswered: 0,
        details: [],
      };

      questions.forEach((question, index) => {
        const answer = correctAnswers[index];
        if (!answer) return;

        let isCorrect = false;
        let isAnswered = false;

        // Handle multiple choice questions
        if (question.querySelector(".quiz-option")) {
          const options = question.querySelectorAll(".quiz-option");
          let selectedOption = null;

          // Check if any option was selected
          options.forEach((opt) => {
            if (
              opt.classList.contains("bg-success") ||
              opt.classList.contains("bg-danger")
            ) {
              selectedOption = opt;
              isAnswered = true;
            }
          });

          // If no option was selected, mark as unanswered
          if (!selectedOption) {
            results.unanswered++;
            options.forEach((opt) => {
              if (
                opt.textContent.toLowerCase().includes(answer.toLowerCase())
              ) {
                opt.classList.add("bg-success");
              }
            });
          }
          // If option was selected, check correctness
          else {
            isCorrect = selectedOption.textContent
              .toLowerCase()
              .includes(answer.toLowerCase());
            if (isCorrect) {
              results.correct++;
            } else {
              results.incorrect++;
              // Highlight correct answer
              options.forEach((opt) => {
                if (
                  opt.textContent.toLowerCase().includes(answer.toLowerCase())
                ) {
                  opt.classList.add("bg-success");
                }
              });
            }
          }
        }
        // Handle input questions
        else if (question.querySelector("input")) {
          const input = question.querySelector("input");
          const userAnswer = input.value.trim();
          isAnswered = userAnswer !== "";

          input.classList.remove("is-valid", "is-invalid");

          if (!isAnswered) {
            results.unanswered++;
            input.classList.add("is-invalid");
            // Show correct answer
            const correctSpan = document.createElement("span");
            correctSpan.className = "text-success ms-2 small";
            correctSpan.textContent = `Correct: ${answer}`;
            question.appendChild(correctSpan);
          } else {
            isCorrect = userAnswer === answer;
            if (isCorrect) {
              results.correct++;
              input.classList.add("is-valid");
            } else {
              results.incorrect++;
              input.classList.add("is-invalid");
              // Show correct answer
              const correctSpan = document.createElement("span");
              correctSpan.className = "text-success ms-2 small";
              correctSpan.textContent = `Correct: ${answer}`;
              question.appendChild(correctSpan);
            }
          }
        }

        results.details.push({
          question: index + 1,
          correct: isCorrect,
          answered: isAnswered,
        });
      });

      // Display comprehensive results
      const feedback = document.getElementById(`${setId}-feedback`);
      if (feedback) {
        const percentage = Math.round((results.correct / results.total) * 100);
        feedback.innerHTML = `
          <div class="alert ${
            percentage === 100 ? "alert-success" : "alert-warning"
          }">
            <strong>Results:</strong> 
            ${results.correct} correct, 
            ${results.incorrect} incorrect,
            ${results.unanswered} unanswered
            (${percentage}%)
            ${
              percentage < 100
                ? '<button class="btn btn-sm btn-outline-primary ms-2" onclick="QuizManager.showAnswers(\'' +
                  setId +
                  "')\">Show Answers</button>"
                : ""
            }
          </div>
        `;
        feedback.scrollIntoView({ behavior: "smooth" });
      }

      return results;
    },

    // Show all correct answers
    showAnswers: function (setId) {
      const set = document.getElementById(setId);
      if (!set) return;

      set.querySelectorAll(".quiz-question").forEach((question) => {
        // Clear previous feedback
        const existingFeedback = question.querySelector(".text-success");
        if (existingFeedback) {
          existingFeedback.remove();
        }

        // For multiple choice
        question.querySelectorAll(".quiz-option").forEach((opt) => {
          opt.classList.remove("bg-success", "bg-danger");
        });

        // For input fields
        question.querySelectorAll("input").forEach((input) => {
          input.classList.remove("is-valid", "is-invalid");
        });
      });
    },

    // Helper functions for specific question types
    validateRational: function (setId, answers) {
      return this.validateSet(setId, answers);
    },
    validateRounding: function (setId, answers) {
      return this.validateSet(setId, answers);
    },
    validateSurds: function (setId, answers) {
      return this.validateSet(setId, answers);
    },
  };

  // Global shortcuts for backward compatibility
  function toggleQuestions(setId) {
    QuizManager.toggleQuestions(setId);
  }

  function selectAnswer(option, correctType) {
    QuizManager.selectAnswer(option, correctType);
  }

  function validateAnswers(setId, answers) {
    return QuizManager.validateSet(setId, answers);
  }

  function validateQuestionSet(setId, answers) {
    return QuizManager.validateSet(setId, answers);
  }

  function validateRationalSet(setId, answers) {
    return QuizManager.validateRational(setId, answers);
  }

  function validateRoundingSet(setId, answers) {
    return QuizManager.validateRounding(setId, answers);
  }

  function validateSurdsSet(setId, answers) {
    return QuizManager.validateSurds(setId, answers);
  }

  // Add these aliases to handle both naming conventions
  function validateRational(setId, answers) {
    return QuizManager.validateRational(setId, answers);
  }

  function validateRounding(setId, answers) {
    return QuizManager.validateRounding(setId, answers);
  }

  function validateSurds(setId, answers) {
    return QuizManager.validateSurds(setId, answers);
  }

  function updateFraction() {
    const slider = document.getElementById("fractionSlider");
    const valueDisplay = document.getElementById("fractionValue");
    const value = slider.value;
    valueDisplay.textContent = "1/" + value;
    const circles = document.querySelectorAll(".fraction-circle");
    circles.forEach((circle) => {
      const filled = circle.querySelector("div");
      filled.style.height = 100 / value + "%";
    });
  }
  function findEquivalents() {
    const num = parseInt(document.getElementById("numerator").value);
    const den = parseInt(document.getElementById("denominator").value);
    const container = document.getElementById("equivalentFractions");
    container.innerHTML = "";
    for (let i = 2; i <= 5; i++) {
      const equivNum = num * i;
      const equivDen = den * i;
      const fraction = document.createElement("span");
      fraction.className = "badge bg-secondary me-2 mb-2";
      fraction.textContent = equivNum + "/" + equivDen;
      container.appendChild(fraction);
    }
  }
  function simplifyFraction() {
    const num = parseInt(document.getElementById("simplifyNum").value);
    const den = parseInt(document.getElementById("simplifyDen").value);
    const gcd = greatestCommonDivisor(num, den);
    const result = document.getElementById("simplifiedResult");
    if (gcd === 1) {
      result.textContent = num + "/" + den + " is already in simplest form";
    } else {
      result.textContent = "Simplified: " + num / gcd + "/" + den / gcd;
    }
  }
  function greatestCommonDivisor(a, b) {
    return b ? greatestCommonDivisor(b, a % b) : a;
  }
  function calculateFraction(operation) {
    const num1 = parseInt(
      document.getElementById(operation === "add" ? "addNum1" : "multNum1")
        .value
    );
    const den1 = parseInt(
      document.getElementById(operation === "add" ? "addDen1" : "multDen1")
        .value
    );
    const num2 = parseInt(
      document.getElementById(operation === "add" ? "addNum2" : "multNum2")
        .value
    );
    const den2 = parseInt(
      document.getElementById(operation === "add" ? "addDen2" : "multDen2")
        .value
    );
    const resultElement = document.getElementById(
      operation === "add" ? "addFractionResult" : "multFractionResult"
    );
    if (operation === "add") {
      const commonDen = den1 * den2;
      const newNum = num1 * den2 + num2 * den1;
      const gcd = greatestCommonDivisor(newNum, commonDen);
      resultElement.textContent =
        "Result: " + newNum / gcd + "/" + commonDen / gcd;
    } else {
      const resultNum = num1 * num2;
      const resultDen = den1 * den2;
      const gcd = greatestCommonDivisor(resultNum, resultDen);
      resultElement.textContent =
        "Result: " + resultNum / gcd + "/" + resultDen / gcd;
    }
  }
  function toggleQuestions(setId) {
    const element = document.getElementById(setId);
    if (element.style.display === "none") {
      element.style.display = "block";
    } else {
      element.style.display = "none";
    }
  }
  function validateFractionAnswers(setId, answers) {
    let allCorrect = true;
    const feedbackDiv = document.getElementById(`${setId}-feedback`);

    // Check each question in the set
    for (let i = 0; i < answers.length; i++) {
      // Updated ID pattern to match your HTML structure
      const inputId = `${setId.replace("Set", "")}-q${i + 1}`;
      const inputElement = document.getElementById(inputId);

      // Check if element exists before trying to access it
      if (!inputElement) {
        console.error(`Element with ID ${inputId} not found`);
        continue;
      }

      const userAnswer = inputElement.value.trim();
      const correctAnswer = answers[i];
      const questionElement = inputElement.parentNode;

      // Use the compareFractions function for proper fraction comparison
      if (compareFractions(userAnswer, correctAnswer)) {
        inputElement.classList.remove("is-invalid");
        inputElement.classList.add("is-valid");
        questionElement.style.color = "green";
      } else {
        inputElement.classList.remove("is-valid");
        inputElement.classList.add("is-invalid");
        questionElement.style.color = "red";
        allCorrect = false;
      }
    }

    // Provide feedback
    if (feedbackDiv) {
      if (allCorrect) {
        feedbackDiv.textContent = "All answers correct! Great job! ðŸŽ‰";
        feedbackDiv.style.color = "green";
      } else {
        feedbackDiv.textContent = "Some answers incorrect. Try again! ðŸ’ª";
        feedbackDiv.style.color = "red";
      }
    }
  }

  // Helper function to compare fractions (accepts equivalent fractions)
  function compareFractions(userAnswer, correctAnswer) {
    // Handle empty answers
    if (!userAnswer) return false;

    // Handle whole numbers
    if (userAnswer === correctAnswer) return true;

    // Parse fractions
    const userParts = userAnswer.split("/");
    const correctParts = correctAnswer.split("/");

    // If not a fraction format, do direct comparison
    if (userParts.length !== 2 || correctParts.length !== 2) {
      return userAnswer === correctAnswer;
    }

    // Convert to numbers
    const userNum = parseInt(userParts[0]);
    const userDen = parseInt(userParts[1]);
    const correctNum = parseInt(correctParts[0]);
    const correctDen = parseInt(correctParts[1]);

    // Check for division by zero
    if (userDen === 0 || correctDen === 0) return false;

    // Cross multiply to check equivalence
    return userNum * correctDen === correctNum * userDen;
  }

  // ===== Helper Functions =====

  // Clear all highlights
  function resetHighlights(element) {
    element.querySelectorAll("p").forEach((p) => {
      p.innerHTML = p.textContent;
    });
  }

  // Escape special characters for regex
  function escapeRegExp(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }

  // Highlight matching words
  function applyHighlights(element, className, wordsToHighlight) {
    const paragraph = element.querySelector("p");
    let text = paragraph.textContent;

    wordsToHighlight.forEach((word) => {
      const regex = new RegExp(`\\b${escapeRegExp(word)}\\b`, "gi");
      text = text.replace(
        regex,
        (match) => `<span class="${className}">${match}</span>`
      );
    });

    paragraph.innerHTML = text;
  }

  // ===== Highlighting Functions =====

  function highlightVerb(element) {
    resetHighlights(element);

    const sentence = element.querySelector("p").textContent;
    const words = sentence.split(/\s+/);

    const verbs = words.filter(
      (word) =>
        /(ing|ed|s)$/i.test(word) ||
        [
          "is",
          "am",
          "are",
          "was",
          "were",
          "have",
          "has",
          "had",
          "do",
          "does",
          "did",
          "will",
          "can",
          "could",
          "shall",
          "should",
          "may",
          "might",
          "must",
        ].includes(word.toLowerCase())
    );

    applyHighlights(element, "highlight-verb", verbs);
  }

  function highlightNoun(element) {
    resetHighlights(element);

    const sentence = element.querySelector("p").textContent;
    const words = sentence.split(/\s+/);

    const nouns = words.filter(
      (word) =>
        /^[A-Z][a-z]*$/.test(word) || // Proper nouns
        ["the", "a", "an"].includes(word.toLowerCase()) ||
        /(tion|ment|ness|ity|ance|ence)$/i.test(word)
    );

    applyHighlights(element, "highlight-noun", nouns);
  }

  function highlightPronoun(element) {
    resetHighlights(element);

    const sentence = element.querySelector("p").textContent;
    const pronouns = [
      "I",
      "me",
      "my",
      "mine",
      "myself",
      "you",
      "your",
      "yours",
      "yourself",
      "he",
      "him",
      "his",
      "himself",
      "she",
      "her",
      "hers",
      "herself",
      "it",
      "its",
      "itself",
      "we",
      "us",
      "our",
      "ours",
      "ourselves",
      "they",
      "them",
      "their",
      "theirs",
      "themselves",
      "this",
      "that",
      "these",
      "those",
      "who",
      "whom",
      "whose",
      "which",
      "what",
      "each",
      "either",
      "neither",
      "some",
      "any",
      "none",
      "all",
      "most",
    ];

    applyHighlights(element, "highlight-pronoun", pronouns);
  }

  // ===== Validation Logic =====

  function validateAnswers(type, correctAnswers) {
    const questions = document.querySelectorAll(`.quiz-question`);
    let allCorrect = true;
    const feedbackDiv = document.querySelector(".feedback");

    questions.forEach((question, index) => {
      if (index >= correctAnswers.length) return;

      const input = question.querySelector("input");
      const userAnswer = input.value.trim().toLowerCase();
      const correct = correctAnswers[index].toLowerCase();

      if (correct.includes(",")) {
        const userSet = new Set(userAnswer.split(",").map((a) => a.trim()));
        const correctSet = new Set(correct.split(",").map((a) => a.trim()));

        const isCorrect =
          userSet.size === correctSet.size &&
          [...userSet].every((val) => correctSet.has(val));

        input.classList.toggle("is-valid", isCorrect);
        input.classList.toggle("is-invalid", !isCorrect);
        if (!isCorrect) allCorrect = false;
      } else {
        const isCorrect = userAnswer === correct;
        input.classList.toggle("is-valid", isCorrect);
        input.classList.toggle("is-invalid", !isCorrect);
        if (!isCorrect) allCorrect = false;
      }
    });

    if (feedbackDiv) {
      feedbackDiv.innerHTML = allCorrect
        ? '<div class="alert alert-success">All answers correct! Well done!</div>'
        : '<div class="alert alert-warning">Some answers need correction. Try again!</div>';
    }
  }

  // ===== Mixed Practice Checker =====

  function checkAnswer(button) {
    const container = button.closest(".sentence-analysis");
    const sentence = container.querySelector(".sentence").textContent.trim();
    const verbInput = container.querySelector("input:nth-of-type(1)");
    const nounInput = container.querySelector("input:nth-of-type(2)");
    const pronounInput = container.querySelector("input:nth-of-type(3)");
    const feedbackDiv = container.querySelector(".feedback");

    // Sentence-specific answers
    let correct = {
      verbs: [],
      nouns: [],
      pronouns: [],
    };

    if (sentence === "The quick brown fox jumps over the lazy dog.") {
      correct = {
        verbs: ["jumps"],
        nouns: ["fox", "dog"],
        pronouns: [],
      };
    }

    const check = (input, correctArr) => {
      const userValues = input.value
        .trim()
        .toLowerCase()
        .split(",")
        .map((v) => v.trim())
        .filter(Boolean);
      const correctValues = correctArr.map((v) => v.toLowerCase());
      const isMatch = arraysEqual(userValues, correctValues);

      input.classList.toggle("is-valid", isMatch);
      input.classList.toggle("is-invalid", !isMatch);

      return isMatch;
    };

    const isVerbCorrect = check(verbInput, correct.verbs);
    const isNounCorrect = check(nounInput, correct.nouns);
    const isPronounCorrect = check(pronounInput, correct.pronouns);

    if (isVerbCorrect && isNounCorrect && isPronounCorrect) {
      feedbackDiv.innerHTML =
        '<div class="alert alert-success">Perfect! All parts of speech identified correctly!</div>';
    } else {
      let feedback =
        '<div class="alert alert-warning"><p>Some corrections needed:</p><ul>';
      if (!isVerbCorrect)
        feedback += `<li>Verbs: ${correct.verbs.join(", ")}</li>`;
      if (!isNounCorrect)
        feedback += `<li>Nouns: ${correct.nouns.join(", ")}</li>`;
      if (!isPronounCorrect && correct.pronouns.length > 0)
        feedback += `<li>Pronouns: ${correct.pronouns.join(", ")}</li>`;
      feedback += "</ul></div>";
      feedbackDiv.innerHTML = feedback;
    }
  }

  // ===== Utility Function =====

  function arraysEqual(a, b) {
    if (a.length !== b.length) return false;
    const sortedA = [...a].sort();
    const sortedB = [...b].sort();
    return sortedA.every((val, index) => val === sortedB[index]);
  }

  // ===== Styles =====

  const style = document.createElement("style");
  style.textContent = `
  .highlight-verb { background-color: #ffcccc; border-radius: 3px; padding: 0 2px; }
  .highlight-noun { background-color: #ccffcc; border-radius: 3px; padding: 0 2px; }
  .highlight-pronoun { background-color: #ccccff; border-radius: 3px; padding: 0 2px; }
  .is-valid { border-color: #28a745; background-color: #e6ffe6; }
  .is-invalid { border-color: #dc3545; background-color: #ffe6e6; }
`;
  document.head.appendChild(style);

  function checkBasicExpansion() {
    const answers = {
      q1: "2x+6",
      q2: "10y-20",
      q3: "-3a-21",
      q4: "xÂ²+5x",
      q5: "6yÂ²-2y",
      q6: "-4a+aÂ²",
      q7: "6b+3c",
      q8: "8xÂ²-12x",
      q9: "-10+6k",
      q10: "pÂ²+pq",
    };
    checkAnswers(answers, "basic-feedback");
  }
  function checkIntermediateExpansion() {
    const answers = {
      q11: "7x+2",
      q12: "y-11",
      q13: "3aÂ²-2a",
      q14: "5b-10c",
      q15: "3xÂ²+4x-6",
      q16: "11-7k",
      q17: "5mÂ²-mn",
      q18: "5p+7",
      q19: "qÂ²-2qr",
      q20: "14x-6y",
    };
    checkAnswers(answers, "intermediate-feedback");
  }
  function checkAdvancedExpansion() {
    const answers = {
      q21: "xÂ²+5x+6",
      q22: "yÂ²-3y-4",
      q23: "6aÂ²-a-2",
      q24: "6+b-bÂ²",
      q25: "xÂ²+10x+25",
      q26: "4kÂ²-12k+9",
      q27: "mÂ²-nÂ²",
      q28: "6pÂ²-pq-2qÂ²",
      q29: "xÂ³+xÂ²-5x+3",
      q30: "6aÂ³-aÂ²-9a+4",
    };
    checkAnswers(answers, "advanced-feedback");
  }
  function checkFactorization() {
    const answers = {
      q31: "3(x+2)",
      q32: "4(y-2)",
      q33: "a(a+5)",
      q34: "3b(2-3b)",
      q35: "2x(x+2y)",
      q36: "3(4k+5)",
      q37: "m(m-n)",
      q38: "4p(2p+3q)",
      q39: "3(3-x)",
      q40: "5xy(x-2y)",
    };
    checkAnswers(answers, "factorization-feedback");
  }
  function checkEvaluation() {
    const answers = {
      q41: "5",
      q42: "6",
      q43: "2",
      q44: "-5",
      q45: "3",
      q46: "-12",
      q47: "10",
      q48: "-12",
      q49: "1",
      q50: "7",
    };
    checkAnswers(answers, "evaluation-feedback");
  }
  function checkAnswers(answers, feedbackId) {
    let correct = 0;
    for (const [id, ans] of Object.entries(answers)) {
      if (document.getElementById(id).value.replace(/\\s/g, "") === ans) {
        correct++;
        document.getElementById(id).className =
          "form-control d-inline-block w-50 border-success";
      } else {
        document.getElementById(id).className =
          "form-control d-inline-block w-50 border-danger";
      }
    }
    const percentage = (correct / Object.keys(answers).length) * 100;
    document.getElementById(feedbackId).innerHTML = `You got ${correct}/${
      Object.keys(answers).length
    } (${percentage}%) correct!`;
    document.getElementById(feedbackId).className =
      percentage >= 80
        ? "ml-2 text-success"
        : percentage >= 50
        ? "ml-2 text-warning"
        : "ml-2 text-danger";
  }

  function checkSet1() {
    const answers = {
      q1: "560",
      q2: "150",
      q3: "160",
      q4: "240",
      q5: "200",
      q6: "270",
      q7: "210",
      q8: "150",
      q9: "240",
      q10: "300",
      q11: "220",
      q12: "260",
      q13: "280",
      q14: "320",
      q15: "360",
      q16: "400",
      q17: "500",
      q18: "600",
      q19: "700",
      q20: "800",
    };
    checkAnswers(answers, "set1-feedback");
  }
  function checkSet2() {
    const answers = {
      q21: "480",
      q22: "600",
      q23: "540",
      q24: "600",
      q25: "750",
      q26: "900",
      q27: "1050",
      q28: "1200",
      q29: "1350",
      q30: "1500",
      q31: "550",
      q32: "650",
      q33: "680",
      q34: "760",
      q35: "920",
      q36: "1080",
      q37: "1160",
      q38: "1240",
      q39: "1320",
      q40: "1480",
    };
    checkAnswers(answers, "set2-feedback");
  }
  function checkSet3() {
    const answers = {
      q41: "1680",
      q42: "1800",
      q43: "1920",
      q44: "2080",
      q45: "2200",
      q46: "2400",
      q47: "2600",
      q48: "2800",
      q49: "3000",
      q50: "3200",
    };
    checkAnswers(answers, "set3-feedback");
  }
  function checkAnswers(answers, feedbackId) {
    let correct = 0;
    for (const [id, ans] of Object.entries(answers)) {
      if (document.getElementById(id).value.replace(/\\s/g, "") === ans) {
        correct++;
        document.getElementById(id).className =
          "form-control d-inline-block w-50 border-success";
      } else {
        document.getElementById(id).className =
          "form-control d-inline-block w-50 border-danger";
      }
    }
    const percentage = (correct / Object.keys(answers).length) * 100;
    document.getElementById(feedbackId).innerHTML = `You got ${correct}/${
      Object.keys(answers).length
    } (${percentage}%) correct!`;
    document.getElementById(feedbackId).className =
      percentage >= 80
        ? "ml-2 text-success"
        : percentage >= 50
        ? "ml-2 text-warning"
        : "ml-2 text-danger";
  }
</script>

{% endblock %}
